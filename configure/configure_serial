# Configure file for compiling using the serial backend only
# Execute from the main directory using `<spatter_home_directory>$ ./configure/configure_<my_platform>`

#Backend type
BACKEND=serial

#Edit these lines to point to your preferred compiler
COMPILER=gnu
CC=gcc
CXX=g++

#Specify a Release or Debug build
BLD_TYPE=Release
#BLD_TYPE=Debug


#Create a build directory that details which version of spatter is being built and run
create_build_directory()
{
	#Add an extra notation to the folder only if a Debug build is used
	#Otherwise just specify the backend and compiler combination
	if [ "$BLD_TYPE" == "Release" ]; 
	then 
		BUILD_DIR=build_${BACKEND}_${COMPILER}
	else
		BUILD_DIR=build_${BACKEND}_${COMPILER}_${BLD_TYPE}
	fi
	#Create directory if needed - clean CMake cached files
	mkdir -p ${BUILD_DIR} && cd ${BUILD_DIR}
	rm -rf CMake*
}


run_cmake()
{
	#Make sure to use tabs rather than spaces for newline entries
	cmake -D CMAKE_BUILD_TYPE=$BLD_TYPE \
		-D CMAKE_C_COMPILER=${CC} \
		-D CMAKE_CXX_COMPILER=${CXX} \
		-D USE_OPENCL=0 \
		-D USE_OPENMP=0 \
		-D USE_CUDA=0 \
		-D USE_SERIAL=1 \
		..
}


#Run the functions
create_build_directory
run_cmake
