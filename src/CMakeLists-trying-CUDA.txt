add_subdirectory(Spatter)

# Define the spatter executable
add_executable(spatter main.cc)

# Apply GPU-specific configurations
if(USE_HIP)
    # set_source_files_properties(main.cc PROPERTIES LANGUAGE HIP)
    target_include_directories(spatter PRIVATE ${HIP_INCLUDE_DIRS})
    target_compile_definitions(spatter PRIVATE USE_HIP)
    target_link_libraries(spatter PRIVATE hip_runtime)
endif()

if(USE_CUDA)
    # set_source_files_properties(main.cc PROPERTIES LANGUAGE CUDA)
    target_include_directories(spatter PRIVATE ${CUDA_INCLUDE_DIRS})
    target_compile_definitions(spatter PRIVATE USE_CUDA)
    target_link_libraries(spatter PRIVATE cudart)
endif()

# Link common libraries
target_link_libraries(spatter PRIVATE ${COMMON_LINK_LIBRARIES} Spatter)

# Set target properties
set_target_properties(spatter PROPERTIES
    COMPILE_DEFINITIONS "${COMMON_COMPILE_DEFINITIONS}"
    COMPILE_OPTIONS "${WARNING_FLAGS}"
    RUNTIME_OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}"
)

